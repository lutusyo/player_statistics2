<!-- matches_app/fixtures.html -->
{% extends 'matches_app/matches_base.html' %}
{% load static %}

{% block title %}{{ team }} Fixtures{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'matches_app/css/fixture_style.css' %}">
{% endblock %}

{% block match_content %}
<div class="fixture-container">

    <h1 class="team-fixtures-title">{{ team }} Fixtures</h1>

    <!-- Upcoming Matches -->
    {% if upcoming_matches %}
        <h2 style="text-align: center; margin-bottom: 20px;">Upcoming Matches</h2>

        {% for match in upcoming_matches %}
            
            <div class="fixture-wrapper">
                
                {% if user.is_authenticated and user.username == 'Azam2' %}
                    <div class="fixture-actions" style="margin-bottom:10px; text-align:center;">
                        {% if match.has_lineup %}
                            <!-- Tagging Links -->
                            <a href="{% url 'tagging_app:tagging_base' match.id %}" class="btn btn-primary">Goal & Pass Tagging</a>
                            <a href="{% url 'tagging_app:enter_goalkeeper_distribution' match.id %}" class="btn btn-secondary">Goalkeeper Distribution</a>
                            <a href="{% url 'defensive_app:enter_defensive_stats' match.id %}" class="btn btn-info">Defensive</a>
                        {% else %}
                            <!-- Create Lineup Only -->
                            <a href="{% url 'lineup_app:create_lineup' match.id %}" class="btn btn-warning">Create Lineup</a>
                        {% endif %}
                    </div>
                {% endif %}

                <a href="{% url 'matches_app:match_detail' match_id=match.id %}" style="text-decoration: none; color: inherit;">
                    <div class="fixture-card">

                        <div class="fixture-header">
                            <div class="fixture-date">
                                {{ match.date|date:"D M d" }} - {{ match.match_time|time:"H:i" }}
                            </div>
                            <div class="fixture-venue">{{ match.venue }}</div>
                            <div class="fixture-type">{{ match.get_competition_type_display }}</div>
                        </div>

                        <div class="fixture-body">
                            <div class="team">
                                {% if match.home_team.logo %}
                                    <img src="{{ match.home_team.logo.url }}" alt="{{ match.home_team }} logo">
                                {% endif %}
                                <div>{{ match.home_team }}</div>
                            </div>

                            <div class="vs">
                                {% if match.home_goals is not None and match.away_goals is not None %}
                                    <strong>{{ match.home_goals }} - {{ match.away_goals }}</strong>
                                {% else %}
                                    <span style="font-size: 14px; color: gray;">vs</span>
                                {% endif %}
                            </div>

                            <div class="team">
                                {% if match.away_team.logo %}
                                    <img src="{{ match.away_team.logo.url }}" alt="{{ match.away_team }} logo">
                                {% endif %}
                                <div>{{ match.away_team }}</div>
                            </div>
                        </div>
                    </div>
                </a>
            </div>

        {% endfor %}

    {% else %}
        <p style="text-align: center;">No upcoming matches.</p>
    {% endif %}

</div>
{% endblock %}
