{% extends "base.html" %}
{% block match_content %}

<!-- Filter Form -->
<form id="filterForm" method="get" style="display: flex; flex-wrap: wrap; align-items: center; gap: 15px; margin-bottom: 20px;">

    <!-- Competition -->
    <div>
        <label for="competition">Competition:</label>
        <select name="competition" id="competition" onchange="document.getElementById('filterForm').submit();">
            {% for value, label in competitions %}
                <option value="{{ value }}" {% if value == competition %}selected{% endif %}>
                    {{ label }}
                </option>
            {% endfor %}
        </select>
    </div>

    <!-- Season -->
    <div>
        <label for="season">Season:</label>
        <select name="season" id="season" onchange="document.getElementById('filterForm').submit();">
            {% for value, label in seasons %}
                <option value="{{ value }}" {% if value == season %}selected{% endif %}>
                    {{ label }}
                </option>
            {% endfor %}
        </select>
    </div>

    <!-- Age Group -->
    <div>
        <label for="age_group">Age Group:</label>
        <select name="age_group" id="age_group" onchange="document.getElementById('filterForm').submit();">
            <option value="">All</option>
            {% for ag in age_groups %}
                <option value="{{ ag.id }}" {% if age_group and ag.id == age_group.id %}selected{% endif %}>
                    {{ ag.name }}
                </option>
            {% endfor %}
        </select>
    </div>

</form>

<h3>{{ competition }} ({{ season }})</h3>
{% endif %}

<table border="1" cellpadding="5">
    <tr>
        <th>Pos</th>
        <th>Team</th>
        <th>P</th>
        <th>W</th>
        <th>D</th>
        <th>L</th>
        <th>GF</th>
        <th>GA</th>
        <th>GD</th>
        <th>Pts</th>
    </tr>

    {% for team, stats in league_table %}
    <tr>
        <td>{{ forloop.counter }}</td>
        <!-- Team with logo -->
        <td style="display: flex; align-items: center; gap: 8px;">
            {% if team.logo %}
                <img src="{{ team.logo.url }}" alt="{{ team.name }} logo" style="width: 30px; height: 30px; object-fit: contain;">
            {% endif %}
            {{ team.name }}
        </td>
        <td>{{ stats.P }}</td>
        <td>{{ stats.W }}</td>
        <td>{{ stats.D }}</td>
        <td>{{ stats.L }}</td>
        <td>{{ stats.GF }}</td>
        <td>{{ stats.GA }}</td>
        <td>{{ stats.GD }}</td>
        <td><strong>{{ stats.Pts }}</strong></td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="10">No data found.</td>
    </tr>
    {% endfor %}
</table>

{% endblock %}
