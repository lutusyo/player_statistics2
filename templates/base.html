{% load static %}
{% load tagging_custom_filters %}
{% load custom_filters %}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>{% block title %}Azam FC{% endblock %}</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Main CSS -->
    <link rel="stylesheet" href="{% static 'accounts_app/css/main.css' %}">

    {% block extra_head %}{% endblock %}

    <style>
        :root {
            --azam-blue: #0b5ed7;
            --azam-blue-dark: #084298;
            --azam-text-light: #ffffff;
            --azam-gray: #f4f6f9;
        }

        html, body {
            height: 100%;
            margin: 0;
            background: var(--azam-gray);
        }

        #page-wrapper {
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }

        #main-wrapper {
            flex: 1;
        }

        /* HEADER */
        #header-wrapper {
            background: linear-gradient(90deg, var(--azam-blue-dark), var(--azam-blue));
            padding: 6px 0;
        }

        #logo img {
            height: 55px;
        }

        #logo h1 a {
            color: var(--azam-text-light);
            font-size: 1.4rem;
            text-decoration: none;
            font-weight: 700;
        }

        /* NAV */
        #nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            gap: 14px;
            align-items: center;
        }

        #nav a {
            color: var(--azam-text-light);
            text-decoration: none;
            padding: 8px 14px;
            font-weight: 500;
            border-radius: 6px;
        }

        #nav a:hover {
            background: rgba(255,255,255,.15);
        }

        /* BOOTSTRAP DROPDOWNS (NO HOVER LOGIC) */
        .dropdown-menu {
            background: var(--azam-blue-dark);
            border-radius: 10px;
            border: none;
            min-width: 200px;
        }

        .dropdown-item {
            color: #ffffff;
            font-weight: 500;
        }

        .dropdown-item:hover {
            background: rgba(255,255,255,.15);
            color: #fff;
        }

        /* SUBMENU */
        .dropdown-submenu {
            position: relative;
        }

        .dropdown-submenu > .dropdown-menu {
            top: 0;
            left: 100%;
        }

        /* FOOTER */
        #footer-wrapper {
            background: var(--azam-blue-dark);
            color: #dbe7ff;
            padding: 16px 0;
        }

        .logout-link {
            background: none;
            border: none;
            color: #fff;
            padding: 8px 14px;
            border-radius: 6px;
        }

        .logout-link:hover {
            background: rgba(255,255,255,.15);
        }

        .nav-active {
            background: rgba(255,255,255,.25);
        }
    </style>
</head>

<body>
<div id="page-wrapper">

<div id="header-wrapper">
<header class="container d-flex justify-content-between align-items-center">

    {% if competition and competition.logo %}
    <div style="position:absolute; top:12px; left:20px;">
        <img src="{{ competition.logo.url }}" style="height:55px;">
    </div>
    {% endif %}

    <div id="logo" class="d-flex align-items-center gap-2">
        <a href="{% url 'home' %}">
            <img src="{% static 'accounts_app/images/logo.png' %}">
        </a>
        <h1 class="m-0">
            <a href="{% url 'home' %}">Azam FC</a>
        </h1>
    </div>

    <nav id="nav">
        <ul>

            <li>
                <a href="{% url 'home' %}" class="{% if request.resolver_match.url_name == 'home' %}nav-active{% endif %}">
                    Home
                </a>
            </li>

            <!-- TEAMS -->
            <li class="dropdown">
                <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#">Teams</a>
                <ul class="dropdown-menu">
                    {% for team in our_teams %}
                    <li>
                        <a class="dropdown-item" href="{% url 'teams_app:team_squad' team.id %}">
                            {{ team.age_group.code }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </li>

            <!-- MATCHES -->
            <li class="dropdown">
                <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#">Matches</a>
                <ul class="dropdown-menu">

                    {% for team in our_teams %}
                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="#">
                            {{ team.age_group.code }}
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item"
                                   href="{% url 'matches_app:team_results' team.age_group.code %}">
                                    All Matches
                                </a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            {% for comp in competition_choices %}
                            <li>
                                <a class="dropdown-item"
                                   href="{% url 'matches_app:team_results' team.age_group.code %}?competition={{ comp.id }}">
                                    {{ comp.name }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>
                    {% endfor %}

                </ul>
            </li>

            <!-- PERFORMANCE -->
            <li class="dropdown">
                <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#">Performance</a>
                <ul class="dropdown-menu">

                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="#">
                            Performance Evaluation
                        </a>
                        <ul class="dropdown-menu">
                            {% for team in our_teams %}
                            <li>
                                <a class="dropdown-item" href="{% url 'performance_rating_app:performance_list' team.id %}">
                                    {{ team.age_group.code }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>

                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="#">
                            GPS Data
                        </a>
                        <ul class="dropdown-menu">
                            {% for team in our_teams %}
                            <li>
                                <a class="dropdown-item" href="{% url 'gps_app:gps_list' team.id %}">
                                    {{ team.age_group.code }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>

                    <li class="dropdown-submenu">
                        <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="#">
                            Technical Reports
                        </a>
                        <ul class="dropdown-menu">
                            {% for team in our_teams %}
                            <li>
                                <a class="dropdown-item" href="{% url 'reports_app:reports_dashboard' team.id %}">
                                    {{ team.age_group.code }}
                                </a>
                            </li>
                            {% endfor %}
                        </ul>
                    </li>

                </ul>
            </li>

            {% if user.is_authenticated %}
            <li>
                <form method="POST" action="{% url 'accounts_app:logout' %}">
                    {% csrf_token %}
                    <button class="logout-link">Logout</button>
                </form>
            </li>
            {% endif %}

        </ul>
    </nav>

</header>
</div>

<div id="main-wrapper">
    {% block content %}{% endblock %}
</div>

<div id="footer-wrapper">
<footer class="container">
    <div class="row">
        <div class="col-md-6">
            <h3>Contact</h3>
            <p>Email: info@azamfc.co.tz</p>
        </div>
        <div class="col-md-6">
            <h3>About</h3>
            <p>Elite youth football development.</p>
        </div>
    </div>
</footer>
</div>

</div>

<!-- BOOTSTRAP JS ONLY -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
