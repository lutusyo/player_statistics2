{% load static %}

<style>
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

/* Fullscreen intro container */
#sp_fullscreen_container {
    height: 100vh;
    width: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: black;
    color: white;
    font-family: Arial, sans-serif;
    position: relative; /* for absolute logo */
    text-align: center;
}

/* Company logo top-right */
#sp_company_logo {
    position: absolute;
    top: 20px;
    right: 20px;
    text-align: right;
}

#sp_company_logo img {
    height: 70px;
    margin-top: 5px;
}

/* Page title */
#sp_title {
    font-size: 48px;
    margin-bottom: 60px;
}

/* Teams section */
#sp_teams {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 80px;
    margin-top: 20px;
}

.sp_team {
    text-align: center;
}

.sp_team img {
    height: 70px;
}

.sp_team_name {
    font-weight: bold;
    margin-top: 8px;
}

.sp_vs {
    font-size: 22px;
    font-weight: bold;
}

/* Dashboard cards and tables */
#sp_dashboard_container {
    padding: 30px 15px;
    background-color: #f8f9fa;
}

.card-body h3 {
    margin: 0;
}
</style>

<!-- Fullscreen Intro Section -->
<div id="sp_fullscreen_container">
    <div id="sp_company_logo">
        <strong>{{ company }}</strong><br>
        <img src="{% static 'goalkeeping_app/azamfc_logo.png' %}" alt="Logo">
    </div>

    <h1 id="sp_title">SET PLAYS</h1>

    <div id="sp_teams">
        <div class="sp_team">
            {% if home_team.logo %}
                <img src="{{ home_team.logo.url }}" alt="{{ home_team.name }}">
            {% endif %}
            <p class="sp_team_name">{{ home_team.name }}</p>
        </div>

        <div class="sp_vs">vs</div>

        <div class="sp_team">
            {% if away_team.logo %}
                <img src="{{ away_team.logo.url }}" alt="{{ away_team.name }}">
            {% endif %}
            <p class="sp_team_name">{{ away_team.name }}</p>
        </div>
    </div>
</div>

<!-- Dashboard Section -->
<div id="sp_dashboard_container" class="container mt-5">

  <!-- Summary Cards -->
  <div class="row text-center mb-4">
    <div class="col-md-3 mb-3">
      <div class="card shadow-sm border-primary">
        <div class="card-body">
          <h6 class="text-primary">Total Set Plays</h6>
          <h3>{{ summary.total_setplays }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card shadow-sm border-info">
        <div class="card-body">
          <h6 class="text-info">Corners</h6>
          <h3>{{ summary.total_corners }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card shadow-sm border-success">
        <div class="card-body">
          <h6 class="text-success">Free Kicks</h6>
          <h3>{{ summary.total_free_kicks }}</h3>
        </div>
      </div>
    </div>
    <div class="col-md-3 mb-3">
      <div class="card shadow-sm border-danger">
        <div class="card-body">
          <h6 class="text-danger">Penalties</h6>
          <h3>{{ summary.total_penalties }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- Chart Section -->
  <div class="card p-4 shadow-sm mb-5">
    <h5 class="text-center mb-4 fw-bold">ðŸ“Š Set Play Overview</h5>
    <img src="data:image/png;base64,{{ chart }}" class="img-fluid" alt="Set Play Chart">
  </div>

  <!-- Detailed Breakdown -->
  <div class="row">
    <div class="col-md-4">
      <div class="card shadow-sm p-3 mb-3">
        <h5 class="text-primary mb-3">Corners ({{ corners.count }})</h5>
        <ul class="list-unstyled">
          {% for c in corners %}
            <li>âš½ {{ c.player }} â€” <em>{{ c.outcome }}</em> ({{ c.minute }}â€™)</li>
          {% empty %}
            <li class="text-muted">No corners recorded.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3 mb-3">
        <h5 class="text-success mb-3">Free Kicks ({{ free_kicks.count }})</h5>
        <ul class="list-unstyled">
          {% for f in free_kicks %}
            <li>ðŸŽ¯ {{ f.player }} â€” <em>{{ f.outcome }}</em> ({{ f.minute }}â€™)</li>
          {% empty %}
            <li class="text-muted">No free kicks recorded.</li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card shadow-sm p-3 mb-3">
        <h5 class="text-danger mb-3">Penalties ({{ penalties.count }})</h5>
        <ul class="list-unstyled">
          {% for p in penalties %}
            <li>ðŸ”¥ {{ p.player }} â€” <em>{{ p.outcome }}</em> ({{ p.minute }}â€™)</li>
          {% empty %}
            <li class="text-muted">No penalties recorded.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>

  <!-- Player Summary Table -->
  <div class="card shadow-sm mt-4 p-3">
    <h5 class="fw-bold mb-3">ðŸ‘¤ Player Contribution Summary</h5>
    <table class="table table-striped table-sm">
      <thead class="table-dark">
        <tr>
          <th>Player</th>
          <th>Type</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        {% for item in player_summary %}
        <tr>
          <td>{{ item.player__name }}</td>
          <td>{{ item.delivery_type }}</td>
          <td>{{ item.total }}</td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="3" class="text-muted text-center">No data available</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

