<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Substitution Panel - {{ match }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        select, input, button { margin: 5px; padding: 5px; }
        .section { margin-bottom: 20px; }
    </style>
</head>
<body>
<a href="{% url 'lineup_app:create_lineup' match.id match.away_team.id %}">BACK</a>
<h1>Substitution Panel</h1>
<h2>{{ match.home_team.name }} vs {{ match.away_team.name }} — {{ match.date }}</h2>

<form method="POST" action="{% url 'lineup_app:record_substitution' match.id %}">
    {% csrf_token %}

    <div class="section">
        <label><strong>Player Out:</strong></label><br>
        <select name="player_out" required>
            <option value="">-- Select Player Out --</option>
            {% for p in home_currently_on_pitch %}
                <option value="{{ p.id }}">{{ p.player.name }} ({{ p.player.position }})</option>
            {% endfor %}
            {% for p in away_currently_on_pitch %}
                <option value="{{ p.id }}">{{ p.player.name }} ({{ p.player.position }})</option>
            {% endfor %}
        </select>
    </div>

    <div class="section">
        <label><strong>Player In:</strong></label><br>
        <select name="player_in" required>
            <option value="">-- Select Player In --</option>
            {% for p in home_bench %}
                {% if p.is_lineup %}
                    <option value="{{ p.id }}">{{ p.name }} ({{ p.position }})</option>
                {% else %}
                    <option value="{{ p.id }}">{{ p.name }} (SUB)</option>
                {% endif %}
            {% endfor %}
        </select>
    </div>

    <div class="section">
        <label><strong>Minute of substitution:</strong></label><br>
        <input type="number" name="minute" min="0" max="120" required>
    </div>

    <button type="submit">Confirm Substitution</button>
</form>

{% if message %}
    <p style="color:green;">{{ message }}</p>
{% endif %}

<hr>
<h3>Current Substitutions</h3>

<ul>
    {% for s in substitutions %}
        <li>{{ s.player_out.player.name }} → {{ s.player_in.player.name }} ({{ s.minute }}')</li>
    {% empty %}
        <li>No substitutions yet.</li>
    {% endfor %}
</ul>

</body>
</html>
