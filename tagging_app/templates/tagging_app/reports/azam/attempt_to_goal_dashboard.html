{% load static %}
{% load custom_filters %}

{% block title %}Attempts at Goal{% endblock %}

<style>
  .attempts-dashboard {
    font-family: Arial, sans-serif;
    background-color: #fdfcf7;
    color: #333;
    padding: 20px;
  }

  .attempts-dashboard h2 {
    margin: 20px 0;
    font-size: 22px;
    font-weight: bold;
  }

  .attempts-dashboard table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
    background: #fff;
  }

  .attempts-dashboard thead {
    background: #000;
    color: #fff;
  }

  .attempts-dashboard thead th {
    padding: 10px;
    text-align: left;
  }

  .attempts-dashboard tbody td {
    padding: 8px 10px;
    border-bottom: 1px solid #ddd;
  }

  .summary-pitch-container {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 20px;
    margin-top: 30px;
  }

  .summary-table {
    width: 45%;
    border-collapse: collapse;
  }
  .summary-table th, .summary-table td {
    border: 1px solid #000;
    padding: 8px;
    text-align: center;
  }
  .summary-table thead {
    background: #000;
    color: #fff;
  }

  .pitch {
    position: relative;
    width: 50%;
    height: 400px;
    background: #eee;
  }
  .pitch-bg {
    width: 100%;
    height: 100%;
  }
  .shot {
    position: absolute;
    font-size: 16px;
    font-weight: bold;
  }
  .shot.goal { color: red; }
  .shot.on-target { color: cyan; }
  .shot.off-target { color: orange; }
  .shot.blocked { color: gold; }
  .shot.incomplete { color: black; }
</style>



<div class="attempts-dashboard">

      <!-- âœ… Goals List Section -->
<h2>Goals</h2>
<table>
  <thead>
    <tr>
      <th>Minute</th>
      <th>Scorer</th>
      <th>Assist</th>
      <th>Pre-Assist</th>
      <th>Delivery Type</th>
      <th>Own Goal</th>
      <th>Team</th>
    </tr>
  </thead>
  <tbody>
    {% for g in goals %}
      <tr>
        <td data-label="Minute">
          {{ g.minute }}{% if g.second %}:{{ g.second|stringformat:"02d" }}{% endif %}
        </td>
        <td data-label="Scorer">
          {% if g.is_own_goal %}
            ðŸ¥… Own Goal
          {% elif g.player %}
            {{ g.player.name }}
          {% else %}
            -
          {% endif %}
        </td>

        <td data-label="Assist">
          {% if g.assist_by %}{{ g.assist_by.name }}{% else %}-{% endif %}
        </td>
        <td data-label="Pre-Assist">
          {% if g.pre_assist_by %}{{ g.pre_assist_by.name }}{% else %}-{% endif %}
        </td>
        <td data-label="Delivery Type">{{ g.get_delivery_type_display }}</td>
        <td data-label="Own Goal">
            {% if g.is_own_goal %}
              âœ… Yes (for {{ g.own_goal_for.name }})
            {% else %}
              No
            {% endif %}
          </td>

        <td data-label="Team">{{ g.team.name }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="7">No goals recorded</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

  <!-- Our Team Attempts -->
  <h2>Our Team Attempts</h2>
  <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Player</th>
        <th>Outcome</th>
        <th>Body Part</th>
        <th>Delivery Type</th>
        <th>Location</th>
      </tr>
    </thead>
    <tbody>
      {% for attempt in our_attempts %}
        <tr>
          <td>{{ attempt.minute }}:{{ attempt.second|stringformat:"02d" }}</td>
          <td>{{ attempt.player.name }}</td>
          <td>{{ attempt.outcome }}</td>
          <td>{{ attempt.get_body_part_display }}</td>
          <td>{{ attempt.get_delivery_type_display }}</td>
          <td>{{ attempt.get_location_tag_display }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="6" style="text-align:center;">No attempts recorded</td></tr>
      {% endfor %}
    </tbody>
  </table>

<div class="summary-pitch-container" style="flex-direction: column; gap: 30px;">

  <!-- OUR TEAM SUMMARY + PITCH SIDE BY SIDE -->
  <div style="display:flex; gap:10px; align-items:flex-start;">
    <!-- Table -->
    <table class="summary-table" style="width:50%;">
      <thead>
        <tr><th>Key</th><th>Outcome</th><th>Shots</th></tr>
      </thead>
      <tbody>
        <tr><td style="color:red;">●</td><td>Goals</td><td>{{ our_summary.goals|default:0 }}</td></tr>
        
        <tr><td style="color:cyan;">●</td><td>On Target</td><td>{{ our_summary.on_target_total|default:0 }}</td></tr>
        
        <tr><td style="color:orange;">●</td><td>Off Target</td><td>{{ our_summary.off_target|default:0 }}</td></tr>
        <tr><td style="color:gold;">●</td><td>Blocked</td><td>{{ our_summary.blocked|default:0 }}</td></tr>
        <tr><td style="color:black;">●</td><td>Incomplete</td><td>{{ our_summary.incomplete|default:0 }}</td></tr>
      </tbody>
    </table>

    <!-- Pitch -->
    <div class="pitch" style="width:50%;">
      <img src="{% static 'images/pitch-2.jpg' %}" alt="Pitch" class="pitch-bg">
      {% for attempt in our_attempts %}
        <div class="shot {{ attempt.outcome|slugify }}" style="top:{{ attempt.y_percent }}%; left:{{ attempt.x_percent }}%;">
          {{ attempt.player.squad_number }}
        </div>
      {% endfor %}
    </div>
  </div>





   <!-- Opponent Team Attempts
  <h2>Opponent Attempts</h2>
  <table>
    <thead>
      <tr>
        <th>Time</th>
        <th>Player</th>
        <th>Outcome</th>
        <th>Body Part</th>
        <th>Delivery Type</th>
        <th>Location</th>
      </tr>
    </thead>
    <tbody>
      {% for attempt in opponent_attempts %}
        <tr>
          <td>{{ attempt.minute }}:{{ attempt.second|stringformat:"02d" }}</td>
          <td>{{ attempt.player.name }}</td>
          <td>{{ attempt.outcome }}</td>
          <td>{{ attempt.get_body_part_display }}</td>
          <td>{{ attempt.get_delivery_type_display }}</td>
          <td>{{ attempt.get_location_tag_display }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="6" style="text-align:center;">No attempts recorded</td></tr>
      {% endfor %}
    </tbody>
  </table> -->

  <!-- OPPONENT SUMMARY + PITCH SIDE BY SIDE (Below Our Team) 
  <div style="display:flex; gap:10px; align-items:flex-start;">
  
    <table class="summary-table" style="width:50%;">
      <thead>
        <tr><th>Key</th><th>Outcome</th><th>Shots</th></tr>
      </thead>
      <tbody>
        <tr><td style="color:red;">●</td><td>Goals</td><td>{{ opponent_summary.goals|default:0 }}</td></tr>
        <tr><td style="color:cyan;">●</td><td>On Target</td><td>{{ opponent_summary.on_target|default:0 }}</td></tr>
        <tr><td style="color:orange;">●</td><td>Off Target</td><td>{{ opponent_summary.off_target|default:0 }}</td></tr>
        <tr><td style="color:gold;">●</td><td>Blocked</td><td>{{ opponent_summary.blocked|default:0 }}</td></tr>
        <tr><td style="color:black;">●</td><td>Incomplete</td><td>{{ opponent_summary.incomplete|default:0 }}</td></tr>
      </tbody>
    </table> -->

    <!-- 
    <div class="pitch" style="width:50%;">
      <img src="{% static 'images/pitch-2.jpg' %}" alt="Pitch" class="pitch-bg">
      {% for attempt in opponent_attempts %}
        <div class="shot {{ attempt.outcome|slugify }}" style="top:{{ attempt.y_percent }}%; left:{{ attempt.x_percent }}%;">
          {{ attempt.player.squad_number }}
        </div>
      {% endfor %}
    </div>
  </div>

</div> -->





