{% load static %}
{% load custom_filters %}

{% block title %}Attempt to Goal Dashboard{% endblock %}

<style>
  /* Scoped styles under .attempt-to-goal-dashboard */
  .attempt-to-goal-dashboard {
    font-family: Arial, sans-serif;
    background-color: #f5f6fa;
    color: #333;
    padding: 15px;
  }

  .attempt-to-goal-dashboard h2 {
    margin-top: 30px;
    margin-bottom: 15px;
    color: #2f3640;
    border-bottom: 2px solid #3498db;
    display: inline-block;
    padding-bottom: 5px;
  }

  .attempt-to-goal-dashboard ul {
    list-style-type: none;
    padding: 0;
    margin-bottom: 20px;
  }

  .attempt-to-goal-dashboard ul li {
    background-color: #ffffff;
    padding: 10px 15px;
    margin-bottom: 5px;
    border-radius: 6px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }

  .attempt-to-goal-dashboard ul li strong {
    color: #3498db;
  }

  .attempt-to-goal-dashboard table {
    width: 100%;
    border-collapse: collapse;
    background-color: #ffffff;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 1px 5px rgba(0,0,0,0.1);
    margin-bottom: 30px;
  }

  .attempt-to-goal-dashboard thead {
    background-color: #3498db;
    color: #fff;
  }

  .attempt-to-goal-dashboard thead th {
    padding: 12px;
    text-align: left;
  }

  .attempt-to-goal-dashboard tbody td {
    padding: 10px;
    text-align: center;
    border-bottom: 1px solid #eee;
  }

  .attempt-to-goal-dashboard tbody tr:nth-child(even) {
    background-color: #f9f9f9;
  }

  .attempt-to-goal-dashboard tbody tr:hover {
    background-color: #f1f1f1;
  }

  @media (max-width: 768px) {
    .attempt-to-goal-dashboard table, 
    .attempt-to-goal-dashboard thead, 
    .attempt-to-goal-dashboard tbody, 
    .attempt-to-goal-dashboard th, 
    .attempt-to-goal-dashboard td, 
    .attempt-to-goal-dashboard tr {
      display: block;
    }
    .attempt-to-goal-dashboard thead tr {
      display: none;
    }
    .attempt-to-goal-dashboard tbody tr {
      margin-bottom: 15px;
      border-bottom: 2px solid #ddd;
      padding: 10px;
    }
    .attempt-to-goal-dashboard tbody td {
      text-align: right;
      padding-left: 50%;
      position: relative;
    }
    .attempt-to-goal-dashboard tbody td::before {
      content: attr(data-label);
      position: absolute;
      left: 15px;
      width: 45%;
      font-weight: bold;
      text-align: left;
    }
  }
</style>

<div class="attempt-to-goal-dashboard">
  <h2>Goal Attempts</h2>
  <table>
    <thead>
      <tr>
        <th>Player</th>
        <th>On Target Goal</th>
        <th>On Target Saved</th>
        <th>Off Target</th>
        <th>Blocked</th>
      </tr>
    </thead>
    <tbody>
      {% for player in players %}
        <tr>
          <td data-label="Player">{{ player.name }}</td>
          <td data-label="On Target Goal">{{ outcomes_matrix|get_item:player.id|get_item:"On Target Goal"|default:0 }}</td>
          <td data-label="On Target Saved">{{ outcomes_matrix|get_item:player.id|get_item:"On Target Saved"|default:0 }}</td>
          <td data-label="Off Target">{{ outcomes_matrix|get_item:player.id|get_item:"Off Target"|default:0 }}</td>
          <td data-label="Blocked">{{ outcomes_matrix|get_item:player.id|get_item:"Blocked"|default:0 }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- âœ… Goals List Section -->
  <h2>Goals</h2>
<h2>Goals</h2>
<table>
  <thead>
    <tr>
      <th>Minute</th>
      <th>Scorer</th>
      <th>Assist</th>
      <th>Pre-Assist</th>
      <th>Delivery Type</th>
      <th>Own Goal</th>
      <th>Team</th>
    </tr>
  </thead>
  <tbody>
    {% for g in goals %}
      <tr>
        <td data-label="Minute">
          {{ g.minute }}{% if g.second %}:{{ g.second|stringformat:"02d" }}{% endif %}
        </td>
        <td data-label="Scorer">
          {% if g.is_own_goal %}
            ðŸ¥… Own Goal
          {% elif g.player %}
            {{ g.player.name }}
          {% else %}
            -
          {% endif %}
        </td>

        <td data-label="Assist">
          {% if g.assist_by %}{{ g.assist_by.name }}{% else %}-{% endif %}
        </td>
        <td data-label="Pre-Assist">
          {% if g.pre_assist_by %}{{ g.pre_assist_by.name }}{% else %}-{% endif %}
        </td>
        <td data-label="Delivery Type">{{ g.get_delivery_type_display }}</td>
        <td data-label="Own Goal">
            {% if g.is_own_goal %}
              âœ… Yes (for {{ g.own_goal_for.name }})
            {% else %}
              No
            {% endif %}
          </td>

        <td data-label="Team">{{ g.team.name }}</td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="7">No goals recorded</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

</div>
